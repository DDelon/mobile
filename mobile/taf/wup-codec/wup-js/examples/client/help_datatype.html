<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Jce For Javascript</title>
       	<link rel="stylesheet" type="text/css" href="main.css">
    </head>
    <body>
		<h4>JCE-JAVASCRIPT版本支持哪些数据类型？</h4>
		<hr />
		V0.1版本支持：<br />

		<table style="margin-left:30px;margin-bottom: 10px" cellpadding="2px" cellspacing="4px" summary="" width="700px">
			<tr>
				<td rowspan="4" width="80px">基本类型</td>
				<td width="400px">boolean</td>
			</tr>
			<tr>
				<td>char(int8)、short(int16)、int(int32)、long long(int64)</td>
			</tr>
			<tr>
				<td>unsigned char(uint8)、unsigned short(uint16)、unsigned int(uint32)</td>
			</tr>
			<tr>
				<td>string</td>
			</tr>
			<tr>
				<td rowspan="4">高级类型</td>
				<td>struct</td>
			</tr>

			<tr>
				<td>vector&lt;byte&gt;(Taf.BinBuffer/ArrayBuffer)</td>
			</tr>
			<tr>
				<td>vector(Taf.Vector)</td>
			</tr>
			<tr>
				<td>map(Taf.Map)</td>				
			</tr>
		</table>

		<strong>基本类型</strong><br />
		基本类型直接使用“var”声明变量即可，其使用方法在JCE中没有做特殊化处理。<br />
		<div style="margin:5px 5px 15px 30px;"><font color="#FF0000">特别注意<br />
			A1：在Javascript中String类型是Unicode编码，在JCE编解码时我们将其转换成了UTF8编码格式；<br/>
			A2：后台服务程序接受到的字符串是UTF8编码，如果需要按照GBK编码的方式处理字符串，需要后台程序先做下转码（UTF8-&gt;GBK）；<br />
			A3：后台服务程序如果使用的是GBK，发送字符串前，需要将其转成UTF8编码。<br /></font></div>

		<strong>vector</strong><br />					
		由于Javascript原生的Array不支持JCE中的一些特殊化操作，所以我们对它进行了一次封装。开发者可按下述的代码理解：<br />
<div class="pre_style" style="width:690px;margin: 5px 5px 15px 30px">
Taf.Vector = function(proto)<br />
{<br />
&nbsp;&nbsp;&nbsp;&nbsp;this.proto = proto;<br />
&nbsp;&nbsp;&nbsp;&nbsp;this.val&nbsp;&nbsp;&nbsp;= new Array();<br />
}<br />
</div>

proto是Vector的<font color="#FF0000">类型原型（类型原型决定了在对Vector编解码时采用的方法，所以声明Vector的时候必须传入正确的类型原型）</font>。<br />
	<div style="margin: 5px 5px 15px 30px;width:690px" class="pre_style">
		目前版本中，我们支持如下类型原型：<br />
		Taf.BOOLEAN, Taf.INT16, Taf.INT32, Taf.INT64, Taf.UINT8, Taf.UINT16, Taf.UInt32, <br />Taf.STRING, Taf.ENUM, Taf.Vector, Taf.Map<br /><br />

	<div style="margin-bottom: 10px">
		例子1：声明vector&lt;int32&gt;的方法<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var vc = new Taf.Vector(new Taf.INT32());
	</div>

	<div style="margin-bottom: 10px">
		例子2：声明vector&lt;string&gt;的方法<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var vc = new Taf.Vector(new Taf.STRING());
	</div>

	<div style="margin-bottom: 10px">
		例子3：声明vector&lt;map&lt;uint32, string&gt; &gt;的方法<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var vc = new Taf.Vector(new Taf.Map(new Taf.UINT32(), new Taf.STRING()));
	</div>

	<div style="margin-bottom: 10px">
		例子4：声明vector&lt;struct&gt;的方法，假设结构体名称为Test.UserBasic<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var vc = new Taf.Vector(new Test.UserBasic());
	</div>
</div>
vector的赋值和读取等，可以直接引用“val”完成。使用示例请参考：<a href="test_vstruct.html">参考1</a> <a href="test_vint.html">参考2</a>。<br /> 


<div style="margin-top: 15px"><strong>map</strong></div>					
由于Javascript没有原生的map，所以我们对它进行了一个简单的封装。开发者可按下述的代码理解：<br />

<div class="pre_style" style="width:690px;margin: 5px 5px 15px 30px">
Taf.Map	= function(kproto, vproto)<br />
{<br />
&nbsp;&nbsp;&nbsp;&nbsp;this.kproto = kproto;<br />
&nbsp;&nbsp;&nbsp;&nbsp;this.vproto = vproto;<br />
&nbsp;&nbsp;&nbsp;&nbsp;this.val&nbsp;&nbsp;&nbsp;&nbsp;= new Object();<br />
};<br /><br />
Taf.Map.prototype.put&nbsp;&nbsp;&nbsp;&nbsp;= function(key, value);<br />
Taf.Map.prototype.get&nbsp;&nbsp;&nbsp;&nbsp;= function(key);<br />
Taf.Map.prototype.remove&nbsp;= function(key);<br />
Taf.Map.prototype.clear&nbsp;&nbsp;= function();<br />
Taf.Map.prototype.size&nbsp;&nbsp;&nbsp;= function();
</div>

kproto是map<font color="#FF0000">关键字的类型原型</font>。<br />
vproto是map<font color="#FF0000">数据值的类型原型</font>。<br />
<div style="margin: 5px 5px 15px 30px;width:690px" class="pre_style">
	<div style="margin-bottom: 10px">
		例子1：声明map&lt;int32, int32&gt;的方法<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var mp = new Taf.Map(new Taf.INT32(), new Taf.INT32());
	</div>

	<div style="margin-bottom: 10px">
		例子2：声明map&lt;uint32, string&gt;的方法<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var mp = new Taf.Map(new Taf.UINT32(), new Taf.STRING());
	</div>

	<div style="margin-bottom: 10px">
		例子3：声明map&lt;string, string&gt;的方法<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var mp = new Taf.Map(new Taf.STRING(), new Taf.STRING());
	</div>

	<div style="margin-bottom: 10px">
		例子4：声明map&lt;string, struct&gt;的方法，假设结构体名称为Test.UserBasic<br>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var mp = new Taf.map(new Taf.STRING(), new Test.UserBasic());
	</div>
</div>
map的赋值和读取等，可以使用类提供的put/get操作，也可以直接引用“val”完成。使用示例请参考：<a href="test_vstruct.html">参考1</a> <a href="test_vint.html">参考2</a>。 

</body>
</html>
